# $Id: attachment.test,v 1.3 2006-12-10 14:40:40 nicm Exp $

!account "account" stdin
!action "action" drop

match attachment count < 0 action "action"
@0 ^added rule: actions="action" matches=attachment count < 0 $
match attachment count > 0 action "action"
@0 ^added rule: actions="action" matches=attachment count > 0 $
match attachment count == 0 action "action"
@0 ^added rule: actions="action" matches=attachment count == 0 $
match attachment count != 0 action "action"
@0 ^added rule: actions="action" matches=attachment count != 0 $

match attachment total-size < 0 action "action"
@0 ^added rule: actions="action" matches=attachment total-size < 0 $
match attachment total-size > 0 action "action"
@0 ^added rule: actions="action" matches=attachment total-size > 0 $

match attachment any-size < 0 action "action"
@0 ^added rule: actions="action" matches=attachment any-size < 0 $
match attachment any-size > 0 action "action"
@0 ^added rule: actions="action" matches=attachment any-size > 0 $

match attachment any-name "string" action "action"
@0 ^added rule: actions="action" matches=attachment any-name "string" $
match attachment any-name "" action "action"
@1 ^/dev/stdin: invalid string at line 3$

match attachment any-type "string" action "action"
@0 ^added rule: actions="action" matches=attachment any-type "string" $
match attachment any-type "" action "action"
@1 ^/dev/stdin: invalid string at line 3$
