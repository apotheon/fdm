# $Id: nested.test,v 1.1 2006-12-01 11:15:48 nicm Exp $

!account "account" stdin
!action "action" drop

match "abc" { match "def" action "action" }
@- ^added rule: nested matches=regexp "abc" in any $
@- ^added rule: actions="action" matches=regexp "def" in any $
@0
match "abc" accounts { } { match "def" action "action" }
@1 ^/dev/stdin: syntax error at line 3$
match "abc" accounts { "account" } { match "def" action "action" }
@- ^added rule: accounts="account" nested matches=regexp "abc" in any $
@- ^added rule: actions="action" matches=regexp "def" in any $
@0
match "abc" account "account" { match "def" action "action" }
@- ^added rule: accounts="account" nested matches=regexp "abc" in any $
@- ^added rule: actions="action" matches=regexp "def" in any $
@0

match "abc" { }
@0 ^added rule: nested matches=regexp "abc" in any $
match "abc" accounts { } { }
@1 ^/dev/stdin: syntax error at line 3$
match "abc" account "account" { }
@0 ^added rule: accounts="account" nested matches=regexp "abc" in any $
match "abc" accounts { "account" } { }
@0 ^added rule: accounts="account" nested matches=regexp "abc" in any $
match "abc" account "account" { }
@0 ^added rule: accounts="account" nested matches=regexp "abc" in any $
