# $Id: nested.test,v 1.2 2007-01-26 10:10:40 nicm Exp $

!account "account" stdin
!action "action" drop

match "abc" { match "def" action "action" }
@- ^added rule 0: nested matches=regexp "abc" in any $
@- ^added rule 1: actions="action" matches=regexp "def" in any $
@0
match "abc" accounts { } { match "def" action "action" }
@1 ^/dev/stdin: syntax error at line 3$
match "abc" accounts { "account" } { match "def" action "action" }
@- ^added rule 0: accounts="account" nested matches=regexp "abc" in any $
@- ^added rule 1: actions="action" matches=regexp "def" in any $
@0
match "abc" account "account" { match "def" action "action" }
@- ^added rule 0: accounts="account" nested matches=regexp "abc" in any $
@- ^added rule 1: actions="action" matches=regexp "def" in any $
@0

match "abc" { }
@0 ^added rule 0: nested matches=regexp "abc" in any $
match "abc" accounts { } { }
@1 ^/dev/stdin: syntax error at line 3$
match "abc" account "account" { }
@0 ^added rule 0: accounts="account" nested matches=regexp "abc" in any $
match "abc" accounts { "account" } { }
@0 ^added rule 0: accounts="account" nested matches=regexp "abc" in any $
match "abc" account "account" { }
@0 ^added rule 0: accounts="account" nested matches=regexp "abc" in any $
